{% extends 'base_user.html.twig' %}

{% block title %}détails facture{% endblock %}


{% block body %}

  <div class="container-fluid">
        <div style = "margin-left: auto ; margin-right: auto ; max-width : 900px;">
            <p class="display-6 no-wrap text-center mb-5">Facture {{ invoice.code }}</p>
            <div class=" d-flex justify-content-center text-center align-center">
                <div class="card" style="width: 18rem;">
                    <ul class="list-group list-group-flush">
                       <li class="list-group-item">
                            {% if invoice.comfirm == true %}
                                <th>Fact-{{ invoice.code }}</th>
                            {% else %}
                                {% if invoice.category == "Fin Mois"%}
                                    <th>Fact en  cours -{{ invoice.code }}</th>
                                {% else %}
                                    <th>Dev-{{ invoice.code }}</th>
                                {% endif %}
                            {% endif %}
                        </li>
                        <li class="list-group-item">Client : <a href="/custpmer/show/{{ invoice.getCustomer().getId() }}" class="card-link"> {{invoice.getCustomer().getName()}} </a> </li>
                        <li class="list-group-item">Transaction : <a href="/transaction/show/{{ invoice.transaction.getId() }}" class="card-link"> {{invoice.getTransaction().getCode()}} </a></li>
                        <li class="list-group-item">{% if invoice.getCategory() != null %} catégorie :  {{invoice.getCategorie()}}{% endif %}</li>  
                    </ul>
                    <div class="card-body">
                        <a href="/invoice/edit/{{ invoice.getId() }}" class="card-link"><i class="fa-solid fa-pen-to-square"></i></a>
                        <a href="/invoice/delete/{{ invoice.getId()}}" class="card-link"><i class="fa-solid fa-trash-can"></i></a>
                        <a href="/invoice/" class="card-link"><i class="fa-solid fa-list"></i></a>
                    </div>
                </div>
            </div>
            <table class="table table-striped">
                <p class="display-6 no-wrap text-center mb-5">Ligne de facture</p>
                <thead>
                    <tr>
                        <th scope="col">Service</th>
                        <th scope="col">Description</th>
                        <th scope="col">Montant HT</th>
                         <th scope="col">taux TVA</th>
                          <th scope="col">Montant TTC</th>
                        <th scope="col">Réduction</th>
                        <th scope="col">Description réduction</th>
                        <th scope="col">Montant réduction</th>
                    </tr>
                </thead>

                <tbody>
                {% for invoiceLine in invoice.invoiceLines %} 
                    <tr>
                        <th>{{invoiceLine.catalogService.name}} </th>
                        <th>{{invoiceLine.catalogService.description}} - {{invoiceLine.quote}}</th>
                        <th>{{invoiceLine.catalogService.amountHt}} €</th>
                        <th>{{invoiceLine.catalogService.tvaRate}} %</th>
                        <th>{{invoiceLine.catalogService.amountTtc}} €</th>
                        <th>{{invoiceLine.catalogDiscount.name}}</th>
                        <th>{{invoiceLine.catalogDiscount.description}}</th>
                        <th>{{invoiceLine.discount}} €</th>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <table class="table table-striped">
                <p class="display-6 no-wrap text-center mb-5">Echéance de payment</p>
                <thead>
                    <tr>
                        <th scope="col">Date prévue</th>
                        <th scope="col">Montant prévu</th>
                        <th scope="col">Moyen prévu</th>
                         <th scope="col">Date réalisée</th>
                        <th scope="col">Montant réalisé</th>
                        <th scope="col">Moyen utilisé</th>
                    </tr>
                </thead>

                <tbody>
                {% for paymentDeadline in invoice.paymentDeadlines %} 
                    <tr>
                        <th>{% if paymentDeadline.expectedPaymentDate is  not null %}{{paymentDeadline.expectedPaymentDate.format('d/m/y')}} {% endif %} </th>
                        <th>{{paymentDeadline.expectedAmount}} €</th>
                        <th>{{paymentDeadline.expectedMeans}}</th>
                        <th>{% if paymentDeadline.actualPaymentDate is not null %}{{paymentDeadline.actualPaymentDate.format('d/m/y')}} {% endif %}</th>
                        <th>{{paymentDeadline.actualAmount}} €</th>
                        <th>{{paymentDeadline.actualMeans}}</th>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
           
        </div>
    </div>


{% endblock %}

